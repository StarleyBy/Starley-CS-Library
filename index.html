<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medical library</title>
    <link rel="stylesheet" href="assets/css/styles.css">
    <style>
        /* ==================== –ê–î–ê–ü–¢–ò–í–ù–´–ô –†–ê–ó–ú–ï–† –®–†–ò–§–¢–ê –ù–ê–ó–í–ê–ù–ò–ô ==================== */
        /* –ò—Å–ø–æ–ª—å–∑—É–µ–º !important —á—Ç–æ–±—ã –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å inline —Å—Ç–∏–ª–∏ –æ—Ç app.js */
        .book-card h3, 
        .book-card .book-title {
            font-size: 1rem !important;
            line-height: 1.3 !important;
            height: auto !important;
            max-height: 2.6em !important;
            overflow: hidden !important;
            display: -webkit-box !important;
            -webkit-line-clamp: 2 !important;
            -webkit-box-orient: vertical !important;
            text-overflow: ellipsis !important;
            margin-bottom: 0.5rem !important;
            word-wrap: break-word !important;
            hyphens: auto !important;
        }
        
        .book-card .book-title.long-title {
            font-size: 0.9rem !important;
            -webkit-line-clamp: 2 !important;
            max-height: 2.4em !important;
        }
        
        .book-card .book-title.very-long-title {
            font-size: 0.8rem !important;
            -webkit-line-clamp: 3 !important;
            max-height: 3.6em !important;
        }
        
        /* –ê–≤—Ç–æ—Ä—ã */
        .book-card p,
        .book-card .book-authors {
            font-size: 0.85rem !important;
            line-height: 1.3 !important;
            height: auto !important;
            max-height: 2.6em !important;
            overflow: hidden !important;
            display: -webkit-box !important;
            -webkit-line-clamp: 2 !important;
            -webkit-box-orient: vertical !important;
            text-overflow: ellipsis !important;
            word-wrap: break-word !important;
        }
        
         /* ==================== –ù–ï–û–ù–û–í–´–ï –ò–ù–î–ò–ö–ê–¢–û–†–´ –í–ï–†–°–ò–ô ==================== */
        .version-badges {
            position: absolute !important;
            top: 6px !important;
            right: 6px !important;
            display: flex !important;
            gap: 3px !important;
            z-index: 10 !important;
        }
        
        .version-badge {
            padding: 3px 7px !important;
            border-radius: 4px !important;
            font-size: 0.6rem !important;
            font-weight: bold !important;
            letter-spacing: 0.5px !important;
            text-transform: uppercase !important;
            backdrop-filter: blur(6px) !important;
            transition: all 0.3s ease !important;
            animation: neon-pulse 2.5s ease-in-out infinite !important;
            opacity: 0.85 !important;
        }
        
        .version-badge.ru {
            background: rgba(231, 76, 60, 0.75) !important;
            color: rgba(255, 255, 255, 0.95) !important;
            text-shadow: 
                0 0 3px rgba(231, 76, 60, 0.8),
                0 0 6px rgba(231, 76, 60, 0.5) !important;
            border: 1px solid rgba(255, 255, 255, 0.25) !important;
            box-shadow: 
                0 0 6px rgba(231, 76, 60, 0.4),
                0 0 12px rgba(231, 76, 60, 0.2),
                inset 0 0 6px rgba(255, 255, 255, 0.08) !important;
        }
        
        .version-badge.star {
            background: rgba(52, 152, 219, 0.75) !important;
            color: rgba(255, 255, 255, 0.95) !important;
            text-shadow: 
                0 0 3px rgba(52, 152, 219, 0.8),
                0 0 6px rgba(52, 152, 219, 0.5) !important;
            border: 1px solid rgba(255, 255, 255, 0.25) !important;
            box-shadow: 
                0 0 6px rgba(52, 152, 219, 0.4),
                0 0 12px rgba(52, 152, 219, 0.2),
                inset 0 0 6px rgba(255, 255, 255, 0.08) !important;
        }
        
        /* EN Badge - –ó–µ–ª—ë–Ω—ã–π –Ω–µ–æ–Ω */
        .version-badge.en {
            background: rgba(46, 204, 113, 0.75) !important;
            color: rgba(255, 255, 255, 0.95) !important;
            text-shadow: 
                0 0 3px rgba(46, 204, 113, 0.8),
                0 0 6px rgba(46, 204, 113, 0.5) !important;
            border: 1px solid rgba(255, 255, 255, 0.25) !important;
            box-shadow: 
                0 0 6px rgba(46, 204, 113, 0.4),
                0 0 12px rgba(46, 204, 113, 0.2),
                inset 0 0 6px rgba(255, 255, 255, 0.08) !important;
        }
        
        @keyframes neon-pulse {
            0%, 100% {
                opacity: 0.85;
                box-shadow: 
                    0 0 6px currentColor,
                    0 0 12px rgba(255, 255, 255, 0.15),
                    inset 0 0 6px rgba(255, 255, 255, 0.08);
            }
            50% {
                opacity: 0.7;
                box-shadow: 
                    0 0 4px currentColor,
                    0 0 8px rgba(255, 255, 255, 0.1),
                    inset 0 0 4px rgba(255, 255, 255, 0.05);
            }
        }
        
        .book-card:hover .version-badge {
            transform: scale(1.05) !important;
            opacity: 0.95 !important;
        }
        
        .book-card[data-full-title]:hover::after {
            content: attr(data-full-title);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #2c3e50;
            color: white;
            padding: 10px 14px;
            border-radius: 6px;
            font-size: 0.85rem;
            font-weight: 500;
            white-space: normal;
            max-width: 280px;
            width: max-content;
            text-align: center;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            margin-bottom: 10px;
            pointer-events: none;
            line-height: 1.4;
        }
        
        .book-card[data-full-title]:hover::before {
            content: '';
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 7px solid transparent;
            border-top-color: #2c3e50;
            margin-bottom: 3px;
            z-index: 1001;
        }
        
        @media (max-width: 768px) {
            .book-card[data-full-title]:hover::after,
            .book-card[data-full-title]:hover::before {
                display: none;
            }
            
            .version-badge {
                font-size: 0.6rem !important;
                padding: 3px 7px !important;
            }
        }
        
        .book-card {
            position: relative !important;
        }
        
        .book-cover-wrapper {
            position: relative !important;
        }
        
        /* –£–±–∏—Ä–∞–µ–º inline —Å—Ç–∏–ª–∏ –æ—Ç app.js */
        .book-title[style],
        .book-authors[style] {
            font-size: inherit !important;
        }
    </style>
</head>
<body>
    <header>
        <h1>üìö Medical library</h1>
        <nav>
            <a href="index.html">Library</a>
            <a href="editor.html">Editor</a>
        </nav>
    </header>

    <main>
        <div class="search-box">
            <input type="text" id="search" placeholder="Search...">
        </div>

        <div id="library-container">
            <div class="loading">Library loading...</div>
        </div>
    </main>

    <footer>
        <p>Starley Library | 2026</p>
    </footer>

    <script src="assets/js/config.js?v=1.1"></script>
    <script src="assets/js/app.js?v=1.3"></script>
    
    <script>
        console.log('üöÄ Enhanced library features loading...');
        
        // –ü–ê–¢–ß–ò–ú —Ñ—É–Ω–∫—Ü–∏—é renderBookCard –∏–∑ app.js
        (function() {
            const originalRenderBookCard = window.renderBookCard;
            
            if (!originalRenderBookCard) {
                console.error('‚ùå renderBookCard not found in app.js!');
                return;
            }
            
            window.renderBookCard = function(bookPath, bookMeta) {
                let html = originalRenderBookCard(bookPath, bookMeta);
                
                const versions = bookMeta.versions || {};
                
                // –°–æ–∑–¥–∞—ë–º badge —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ –¥–æ—Å—Ç—É–ø–Ω–∞—è –≤–µ—Ä—Å–∏—è
                if (versions.original || versions.russian || versions.starley) {
                    let badgesHtml = '<div class="version-badges">';
                    
                    // EN badge —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —è–≤–Ω–æ —É–∫–∞–∑–∞–Ω original: true
                    if (versions.original === true) {
                        badgesHtml += '<span class="version-badge en">EN</span>';
                    }
                    
                    if (versions.russian === true) {
                        badgesHtml += '<span class="version-badge ru">RU</span>';
                    }
                    
                    if (versions.starley === true) {
                        badgesHtml += '<span class="version-badge star">‚≠ê</span>';
                    }
                    
                    badgesHtml += '</div>';
                    
                    html = html.replace(
                        '<div class="book-cover-wrapper">',
                        '<div class="book-cover-wrapper">' + badgesHtml
                    );
                }
                
                const titleLength = bookMeta.title.length;
                if (titleLength > 80) {
                    html = html.replace('class="book-title"', 'class="book-title very-long-title"');
                    html = html.replace(
                        'class="book-card"',
                        `class="book-card" data-full-title="${bookMeta.title.replace(/"/g, '&quot;')}"`
                    );
                } else if (titleLength > 50) {
                    html = html.replace('class="book-title"', 'class="book-title long-title"');
                    html = html.replace(
                        'class="book-card"',
                        `class="book-card" data-full-title="${bookMeta.title.replace(/"/g, '&quot;')}"`
                    );
                }
                
                return html;
            };
            
            console.log('‚úÖ renderBookCard successfully patched!');
        })();
        
        // –ü–û–õ–ù–û–°–¢–¨–Æ –û–¢–ö–õ–Æ–ß–ê–ï–ú adjustFontSize –∏ adjustAllFontSizes
        (function() {
            // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è adjustFontSize
            window.adjustFontSize = function() {
                // –ù–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º
            };
            
            // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è adjustAllFontSizes
            window.adjustAllFontSizes = function() {
                // –ù–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º
                console.log('‚è≠Ô∏è  adjustAllFontSizes disabled - using CSS instead');
            };
            
            console.log('‚úÖ Font adjustment functions disabled');
        })();
        
        // –ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ DOM —É–¥–∞–ª—è–µ–º –≤—Å–µ inline —Å—Ç–∏–ª–∏ —Å font-size
        window.addEventListener('load', function() {
            setTimeout(function() {
                console.log('üßπ Cleaning up inline font-size styles...');
                
                document.querySelectorAll('.book-title, .book-authors').forEach(element => {
                    // –£–¥–∞–ª—è–µ–º —Ç–æ–ª—å–∫–æ font-size –∏–∑ inline —Å—Ç–∏–ª–µ–π
                    if (element.style.fontSize) {
                        element.style.fontSize = '';
                        console.log('   ‚úì Removed inline font-size from:', element.textContent.substring(0, 30) + '...');
                    }
                });
                
                console.log('‚úÖ Cleanup complete!');
            }, 200);
        });
        
        console.log('‚úÖ Enhanced library features loaded');
    </script>
</body>
</html>
